{% extends "base.html" %}

{% block content %}
<h2>{{ user.username }}的个人主页</h2>

<p>真实姓名: {{ user.real_name }}</p>
<p>邮箱: {{ user.email }}</p>
<p>手机号: {{ user.phone }}</p>
<p>注册时间: {{ user.registered_on }}</p>
<p>上次登录时间: {{ user.last_login }}</p>
<p>权限等级: {{ user.permission_level }}</p>

<!--{% if can_edit %}-->
<!--<form method="POST">-->
<!--    <label for="username">修改用户名:</label>-->
<!--    <input type="text" name="username" id="username" value="{{ user.username }}" required>-->
<!--    <br>-->
<!--    <input type="submit" value="更新用户名">-->
<!--</form>-->
<!--{% else %}-->
<!--<p>您没有权限修改此用户的信息。</p>-->
<!--{% endif %}-->


<h3>修改个人信息</h3>
{% if can_edit %}
<form method="POST" action="{{ url_for('profile', user_id=user.id) }}">
    <label for="username">用户名:</label>
    <input type="text" name="username" id="username" value="{{ user.username }}" required>
    <br>
    <label for="password">密码:</label>
    <input type="password" name="password" id="password">
    <br>
    <label for="real_name">真实姓名:</label>
    <input type="text" name="real_name" id="real_name" value="{{ user.real_name }}">
    <br>
    <label for="email">邮箱:</label>
    <input type="email" name="email" id="email" value="{{ user.email }}">
    <br>
    <label for="phone">手机号:</label>
    <input type="text" name="phone" id="phone" value="{{ user.phone }}">
    <br>
    <input type="submit" value="保存更改">
    <h3>文件</h3>
    <a href="{{ url_for('upload') }}">上传文件</a>
</form>
{% endif %}


<ul>
    {% for file in user.files %}
    <li><a href="{{ url_for('download', file_id=file.id) }}">{{ file.filename }}</a> (下载次数: {{ file.download_count }})</li>
    {% endfor %}
</ul>

{% if can_delete %}
<form method="POST" action="{{ url_for('delete_account', user_id=user.id) }}">
    <input type="submit" value="注销账号" onclick="return confirm('确定要注销账号吗？此操作不可恢复！')">
</form>
{% endif %}

{% endblock %}
